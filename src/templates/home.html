{% extends "layout.html" %}
{% block body %}
<style>
    td {
        max-width: 300px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
</style>

<div class="d-sm-none">
    <div>
        <div class=" dropdown">
            <button class="btn btn-secondary dropdown-toggle px-5" type="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Filter
            </button>
            <ul class="dropdown-menu dropdown-menu-dark">
                <li><a class="dropdown-item" href="{{ url_for('main.home') }}">All</a></li>
                <li>
                    <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="{{ url_for('mangas.sort_manga', sort_func='Reading') }}">Reading</a>
                </li>
                <li><a class="dropdown-item"
                        href="{{ url_for('mangas.sort_manga', sort_func='Completed') }}">Completed</a></li>
                <li><a class="dropdown-item" href="{{ url_for('mangas.sort_manga', sort_func='On hold') }}">On Hold</a>
                </li>
                <li><a class="dropdown-item" href="{{ url_for('mangas.sort_manga', sort_func='Dropped') }}">Dropped</a>
                </li>
                <li><a class="dropdown-item" href="{{ url_for('mangas.sort_manga', sort_func='Plan to read') }}">Plan To
                        Read</a></li>
                <li><a class="dropdown-item"
                        href="{{ url_for('mangas.sort_manga', sort_func='Rereading') }}">Rereading</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="d-none d-sm-block">
    <div class="d-flex mb-5 mt-3">
        <a class="btn btn-info rounded-0 flex-grow-1" href="{{ url_for('main.home') }}"><b>All</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='Reading') }}"><b>Reading</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='Completed') }}"><b>Completed</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='On hold') }}"><b>On
                Hold</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='Dropped') }}"><b>Dropped</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='Plan to read') }}"><b>Plan To Read</b></a>
        <a class="btn btn-info rounded-0 flex-grow-1"
            href="{{ url_for('mangas.sort_manga', sort_func='Rereading') }}"><b>Rereading</b></a>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-dark table-striped align-middle">
        <thead>
            <!-- Searches the config file to see what columns to show -->
            {% for i in show %}
            {% if show[i] == "Yes" %}
            <th scope="col">{{ i.replace("show_", "").replace("_", " ").title() }}</th>
            {% endif %}
            {% endfor %}
        </thead>
        <tbody>
            <tr class="align-middle">
                {% for manga in mangas %}
                <show_cover>
                    {% if show["show_cover"] == "Yes" %}
                    <!-- Hard coded cover to be a svg file instead of png file because of backwards compatibility -->
                    {% if manga.cover == "default.png" %}
                    <td><img src="{{ url_for('static', filename='manga_cover/default.svg') }}" alt="Manga Cover"
                            style="height: 13vh; max-width: 65px;"></td>
                    {% else %}
                    <td><img src="{{ url_for('static', filename='manga_cover/' + manga.cover) }}" alt="Manga Cover"
                            style="height: 13vh; max-width: 65px;"></td>
                    {% endif %}
                    {% endif %}
                </show_cover>
                <show_title>
                    <td><a href="{{ url_for('mangas.update_manga', manga_id=manga.id) }}"
                            class="text-decoration-none text-reset"><u>{{ manga.title }}</u></a></td>
                </show_title>
                <if_status_plan_to_read>
                    {% if manga.status == "Plan to read" %}
                    <show_score>
                        {% if show["show_score"] == "Yes" %}
                        <td>-</td>
                        {% endif %}
                    </show_score>
                    <show_volume>
                        {% if show["show_volume"] == "Yes" %}
                        <td>-</td>
                        {% endif %}
                    </show_volume>
                    <show_chapter>
                        {% if show["show_chapter"] == "Yes" %}
                        <td>-</td>
                        {% endif %}
                    </show_chapter>
                    <show_start_date>
                        {% if show["show_start_date"] == "Yes" %}
                        <td>-</td>
                        {% endif %}
                    </show_start_date>
                    <show_end_date>
                        {% if show["show_end_date"] == "Yes" %}
                        <td>-</td>
                        {% endif %}
                    </show_end_date>
                    <show_status>
                        {% if show["show_status"] == "Yes" %}
                        <td>{{ manga.status }}</td>
                        {% endif %}
                    </show_status>
                </if_status_plan_to_read>
                {% else %}
                <else_status_NOT_plan_to_read>
                    <show_score>
                        {% if show["show_score"] == "Yes" %}
                        <td>{{ manga.score }}</td>
                        {% endif %}
                    </show_score>
                    <show_volume>
                        {% if show["show_volume"] == "Yes" %}
                        <td><a href="{{ url_for('mangas.add_one_volume', manga_id=manga.id, number=manga.volume) }}"
                                class="text-decoration-none text-reset"><u>{{ manga.volume }}</u></a></td>
                        {% endif %}
                    </show_volume>
                    <show_chapter>
                        {% if show["show_chapter"] == "Yes" %}
                        <td><a href="{{ url_for('mangas.add_one_chapter', manga_id=manga.id, number=manga.chapter) }}"
                                class="text-decoration-none text-reset"><u>{{ manga.chapter }}</u></a></td>
                        {% endif %}
                    </show_chapter>
                    <show_start_date>
                        {% if show["show_start_date"] == "Yes" %}
                        {% if manga.start_date == date %}
                        <td>-</td>
                        {% else %}
                        <td>{{ manga.start_date }}</td>
                        {% endif %}
                        {% endif %}
                    </show_start_date>
                    <show_end_date>
                        {% if show["show_end_date"] == "Yes" %}
                        {% if manga.end_date == date %}
                        <td>-</td>
                        {% else %}
                        <td>{{ manga.end_date }}</td>
                        {% endif %}
                        {% endif %}
                    </show_end_date>
                    <show_status>
                        {% if show["show_status"] == "Yes" %}
                        <td>{{ manga.status }}</td>
                        {% endif %}
                    </show_status>
                    {% endif %}
                </else_status_NOT_plan_to_read>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock body %}